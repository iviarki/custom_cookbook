<VirtualHost *:80>

  LogLevel <%= node[:apache][:log_level] %>
  ErrorLog <%= node[:apache][:log_dir] %>/<%= @params[:name] %>-error.log
  CustomLog <%= node[:apache][:log_dir] %>/<%= @params[:name] %>-access.log combined

  FileETag none

  RewriteEngine On
  <% if node[:apache][:version].nil? || node[:apache][:version] == '2.2' -%>
  RewriteLog <%= node[:apache][:log_dir] %>/<%= @application_name %>-rewrite.log
  RewriteLogLevel 0
  <% end -%>

  # Canonical host, <%= @params[:server_name] %>
   RewriteCond %{HTTP_HOST}   !^<%= @params[:server_name] %> [NC]
       RewriteCond %{HTTP_HOST}   !^$
         RewriteRule ^/(.*)$        http://<%= @params[:server_name] %>/$1 [L,R=301]
  
           RewriteCond %{DOCUMENT_ROOT}/system/maintenance.html -f
             RewriteCond %{SCRIPT_FILENAME} !maintenance.html
               RewriteRule ^.*$ /system/maintenance.html [L]
  
               </VirtualHost>
